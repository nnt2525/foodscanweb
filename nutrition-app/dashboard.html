<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - NutriTrack</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="page-wrapper">
        <main class="main-content">
            <div class="container fade-in">
                <!-- Greeting -->
                <div class="mb-6">
                    <h1 class="text-3xl font-bold" id="greeting">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ!</h1>
                    <p class="text-gray">‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-4 grid-responsive mb-8">
                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray">‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</span>
                            <span class="stat-card-icon">üî•</span>
                        </div>
                        <p class="stat-card-value" id="todayCalories">1,850</p>
                        <p class="stat-card-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 2,000 kcal</p>
                        <div class="progress-bar mt-3">
                            <div class="progress-bar-fill" id="caloriesProgress" style="width: 92.5%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray">‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô</span>
                            <span class="stat-card-icon">üí™</span>
                        </div>
                        <p class="stat-card-value" style="color: #3b82f6;">45g</p>
                        <p class="stat-card-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 50g</p>
                        <div class="progress-bar mt-3">
                            <div class="progress-bar-fill blue" style="width: 90%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray">‡∏Ñ‡∏≤‡∏£‡πå‡πÇ‡∏ö‡πÑ‡∏Æ‡πÄ‡∏î‡∏£‡∏ï</span>
                            <span class="stat-card-icon">üçö</span>
                        </div>
                        <p class="stat-card-value" style="color: #f59e0b;">250g</p>
                        <p class="stat-card-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 300g</p>
                        <div class="progress-bar mt-3">
                            <div class="progress-bar-fill orange" style="width: 83%"></div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-gray">‡πÑ‡∏Ç‡∏°‡∏±‡∏ô</span>
                            <span class="stat-card-icon">ü•ë</span>
                        </div>
                        <p class="stat-card-value" style="color: #8b5cf6;">55g</p>
                        <p class="stat-card-label">‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: 70g</p>
                        <div class="progress-bar mt-3">
                            <div class="progress-bar-fill"
                                style="width: 78%; background: linear-gradient(135deg, #8b5cf6, #7c3aed);"></div>
                        </div>
                    </div>
                </div>

                <!-- Chart & Quick Actions -->
                <div class="grid grid-cols-3 grid-responsive mb-8">
                    <div class="card" style="grid-column: span 2;">
                        <h2 class="text-xl font-bold mb-4">‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 7 ‡∏ß‡∏±‡∏ô</h2>
                        <div style="height: 250px;">
                            <canvas id="caloriesChart"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <h2 class="text-xl font-bold mb-4">‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πà‡∏ß‡∏ô</h2>
                        <div class="flex flex-col gap-4">
                            <a href="search.html" class="btn btn-secondary btn-block">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£</a>
                            <a href="scanner.html" class="btn btn-secondary btn-block">üì∏ ‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</a>
                            <a href="planner.html" class="btn btn-secondary btn-block">üìÖ ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏°‡∏∑‡πâ‡∏≠</a>
                            <a href="progress.html" class="btn btn-primary btn-block">üìä ‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</a>
                        </div>
                    </div>
                </div>

                <!-- Recent Foods -->
                <div class="card mb-8">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-bold">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
                        <a href="planner.html" class="text-primary">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚Üí</a>
                    </div>
                    <div class="grid grid-cols-4 grid-responsive" id="recentFoods"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/data.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/navigation.js"></script>
    <script>
        // Check auth
        if (!requireAuth()) throw new Error('Not authorized');

        // Set greeting
        const user = getCurrentUser();
        document.getElementById('greeting').textContent = `${getGreeting()}, ${user.name}!`;

        // Render recent foods
        const recentFoodsEl = document.getElementById('recentFoods');
        mockFoods.slice(0, 4).forEach(food => {
            recentFoodsEl.innerHTML += `
                <a href="food-detail.html?id=${food.id}" class="food-card">
                    <img src="${food.image}" alt="${food.name}" class="food-card-image">
                    <div class="food-card-content">
                        <h3 class="food-card-title">${food.name}</h3>
                        <p class="food-card-category">${food.category}</p>
                        <span class="food-card-calories">${food.calories} kcal</span>
                    </div>
                </a>
            `;
        });

        // Chart
        const ctx = document.getElementById('caloriesChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: mockProgressData.labels,
                datasets: [{
                    label: '‡πÅ‡∏Ñ‡∏•‡∏≠‡∏£‡∏µ‡πà',
                    data: mockProgressData.calories,
                    borderColor: '#22c55e',
                    backgroundColor: 'rgba(34, 197, 94, 0.1)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: false, min: 1500, max: 2500 }
                }
            }
        });
    </script>
</body>

</html>